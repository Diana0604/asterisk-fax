[manage_calls]
exten => sound_wait,1,Verbose(1, managing new call)
;get step from db
same => n,Set(STEP=${DB(WESTILLFAX/step)})
;send email step has been dialed
same => n,System(sendemail -f diana.vallverdu@gmail.com -t antsonstilts@gmail.com -m 'DIALED call to step: ${STEP}' -u 'INFO' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
;set waiting time from database
;same => n,Set(WAIT_TIME=${DB(WESTILLFAX/call_length/${STEP})})
;wait time for call
;same => n,Wait(${WAIT_TIME})
;set step to next
;same => n,Set(DB(WESTILLFAX/step)=${MATH(${STEP}+1,i)})
;send email info that call has finished
same => n,System(sendemail -f diana.vallverdu@gmail.com -t diana.vallverdu@gmail.com -m 'FINISHED call to step: ${STEP}' -u 'INFO' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
;hangup
same => n,Hangup()

exten => sound_play,1,Verbose(1, playing call from fax machine)
same => n,Playback(${ARG1})

;HEALTHCHECK COMS
[healthchecks]
exten => 00,1,Verbose(1, call zero)
same => n,Wait(5)
same => n,Set(MACHINE=${DB(WESTILLFAX/machine)})
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'PLAYING healthcall #1' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Background(faxmachine/02_healthcall.1)
same => n,Hangup()

exten => 1989,1,Wait(2)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'they have pressed 1989' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/02_healthcall.2)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED healthcall #1 - 1st iteration' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/step)=03)
same => n,Background(faxmachine/02_healthcall.3)
same => n,Hangup()

exten => 5,1,Wait(2)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'REPEATING healthcall #1' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/02_healthcall.2)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED healthcall #1 - 2nd iteration' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

exten => i,1,Background(sorry)
same => n,Hangup()

[healthchecks]
exten => 01,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'SENDING healthfax #1' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/03_healthfax1.tif)
same => n,Set(DB(WESTILLFAX/step)=04)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHING healthfax #1' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

[from-internal-custom]
exten => 123ok,1,Verbose(1, received healthcall)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'PLAYING 123' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=100)
same => n,Wait(50)
;same => n,Playback(faxmachine/04_receive_healthchecks.1)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED 123 - 1st iteration' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
;same => n,Background(faxmachine/04_receive_healthchecks.2)
exten => 123ok,n,Return()

exten => 123,1,Verbose(1, healthline called received)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 123' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 04]?123ok,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 05]?123ok,1)
same => n,Hangup()

exten => 5,1,Wait(2)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'REPLAYING 123' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/04_receive_healthchecks.1)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED 123 - 2nd iteration' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

exten => i,1,Background(sorry)
same => n,Hangup()

[from-internal-custom]
exten => 456ok,1,Set(FAXDEST=/tmp)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'RECEIVING 456 fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(tempfax=${STRFTIME(,,%C%y%m%d%H%M)})
same => n,Verbose(1, ${FAXDEST}/${tempfax}.tif,d)
same => n,ReceiveFax(${FAXDEST}/${tempfax}.tif,d)
same => n,Set(DB(WESTILLFAX/step)=06)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -a ${FAXDEST}/${tempfax}.tif -m 'FINISHED 456 fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

exten => 456,1,Verbose(1, sending fax)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 456' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 05]?456ok,1)
same => n,Hangup()

;----------------------- TBL COMS PART 1 -------------------------------


;what we send
[tbl]
exten => helloworld,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'SENDING helloworld fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/06_helloworld.tif)
same => n,Set(DB(WESTILLFAX/step)=07)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED helloworld fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

;Hellowolrd-send Declaration to 900
[from-internal-custom]
exten => 900ok,1,Set(FAXDEST=/tmp)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'RECEIVING 900 fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(tempfax=${STRFTIME(,,%C%y%m%d%H%M)})
same => n,ReceiveFax(${FAXDEST}/${tempfax}.tif,d)
same => n,Set(DB(WESTILLFAX/step)=08)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -a ${FAXDEST}/${tempfax}.tif -m 'FINISHED 900 fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

exten => 900,1,Verbose(1, receiving fax)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 900' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 07]?900ok,1)
same => n,Hangup()

[tbl]
exten => notarobot,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'SENDING not a robot fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/08_notarobot.tif)
same => n,Set(DB(WESTILLFAX/step)=09)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED not a robot fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

[from-internal-custom]
exten => 2019ok,1,Playback(faxmachine/09_describe_world)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'RECORDING 2019' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,MixMonitor(/var/lib/asterisk/sounds/en/faxmachine/27_recording.wav)
same => n,Set(DB(WESTILLFAX/step)=10)
same => n,Wait(20)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED recording 2019' -u 'Machine ${MACHINE}' -a '/var/lib/asterisk/sounds/en/faxmachine/27_recording.wav' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Return()


exten => 2019,1,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 2019 - record the internet' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 09]?2019ok,1)
same => n,Hangup()

[tbl]
exten => questionaire,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'SENDING questionnaire fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/10_questionnaire.tif)
same => n,Set(DB(WESTILLFAX/step)=11)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED questionnaire fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

;Questionnaire-Send Questionaire to 901
[from-internal-custom]
exten => questok,1,Set(FAXDEST=/tmp)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'RECEIVING questionnaire fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(tempfax=${STRFTIME(,,%C%y%m%d%H%M)})
same => n,ReceiveFax(${FAXDEST}/${tempfax}.tif,d)
same => n,Set(DB(WESTILLFAX/step)=12)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -a ${FAXDEST}/${tempfax}.tif -m 'FINISHED questionnaire fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;exten => 901,1,Verbose(1, receiving fax)
;same => n,GosubIf($[${DB(WESTILLFAX/step)} = 11]?questok,1)
;same => n,Hangup()

exten => 1,1,Verbose(1, receiving fax)
same => n,Set(DB(WESTILLFAX/agent)=1)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 1 - questionnaire agent 1' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 11]?questok,1)
same => n,Hangup()

exten => 2,1,Verbose(1, receiving fax)
same => n,Set(DB(WESTILLFAX/agent)=2)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 2 - questionnaire agent 2' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 11]?questok,1)
same => n,Hangup()

exten => 3,1,Verbose(1, receiving fax)
same => n,Set(DB(WESTILLFAX/agent)=3)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 3 - questionnaire agent 3' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 11]?questok,1)
same => n,Hangup()

[tbl]
exten => openhatch,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'SENDING hatch fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(STEP=${DB(WESTILLFAX/agent)})
same => n,Verbose(1,/fax/tifs/12_openhatch_agent${STEP}.tif)
same => n,SendFax(/fax/tifs/12_openhatch_agent${STEP}.tif)
same => n,Set(DB(WESTILLFAX/step)=13)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED hatch fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

[from-internal-custom]
exten => 555ok,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'PLAYING 555 - antenna' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/14_cant_hear)
same => n,Set(DB(WESTILLFAX/step)=15)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED 555 - antenna' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Return()

exten => 555,1,Verbose(1, healthline called received)
same => n,Verbose(1, ${DB(WESTILLFAX/step)})
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 555 - antenna' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 14]?555ok,1)
same => n,Hangup()

[tbl]
exten => mass,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'SENDING mass fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/16_mass.tif)
same => n,Set(DB(WESTILLFAX/step)=17)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED mass fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

;Mass-send Space Drawing to 902
[from-internal-custom]
exten => 999ok,1,Set(FAXDEST=/tmp)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'RECEIVING 999 - space drawing' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(tempfax=${STRFTIME(,,%C%y%m%d%H%M)})
same => n,ReceiveFax(${FAXDEST}/${tempfax}.tif,d)
same => n,Set(DB(WESTILLFAX/step)=18)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -a ${FAXDEST}/${tempfax}.tif -m 'FINISHED 999 - space drawing' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

exten => 999,1,Verbose(1, receiving fax)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -a ${FAXDEST}/${tempfax}.tif -m 'They have dialed 999 - space drawing' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 17]?999ok,1)
same => n,Hangup()

[from-internal-custom]
exten => 3892019837628ok,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'PLAYING 3892019837628ok - ask for sacrifice' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/21_tbl_askforsacrifice)
same => n,Set(DB(WESTILLFAX/step)=22)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED 3892019837628ok - ask for sacrifice' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Return()

exten => 3892019837628,1,Verbose(1, healthline called received)
same => n,Verbose(1, ${DB(WESTILLFAX/step)})
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 3892019837628ok - ask for sacrifice' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?3892019837628ok,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 22]?3892019837628ok,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 23]?3892019837628ok,1)
same => n,Hangup()

;tbl_askfor_sacrifice-send sacrifice to 903
[from-internal-custom]
exten => 903ok,1,Set(FAXDEST=/tmp)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'RECEIVING 903 - sacrifice' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(tempfax=${STRFTIME(,,%C%y%m%d%H%M)})
same => n,ReceiveFax(${FAXDEST}/${tempfax}.tif,d)
same => n,Set(DB(WESTILLFAX/step)=24)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED 903 - sacrifice' -a ${FAXDEST}/${tempfax}.tif -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

exten => 903,1,Verbose(1, receiving fax)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 903 - sacrifice' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 23]?903ok,1)
same => n,Hangup()

[from-internal-custom]
exten => 17121273324ok,1,Set(DB(WESTILLFAX/step)=26)
same => n,Hangup()

exten => 17121273324,1,Verbose(1, called wormhole)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'They have dialed 17121273324 - open wormhole' -u 'Machine ${Machine}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 25]?17121273324ok,1)
same => n,Hangup()

;mashup1
[tbl]
exten => mashup1,1,Verbose(1, Starting mashup)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'STARTING mashup 1 - fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/26_calls_fax_1.tif)
same => n,Set(DB(WESTILLFAX/step)=27)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED mashup 1 - fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

;mashup2
[tbl]
exten => mashup2,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'STARTING mashup 2 - recording playback' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/27_recording)
same => n,Set(DB(WESTILLFAX/step)=28)
same => n,Playback(faxmachine/27_recording)
same => n,Playback(faxmachine/27_recording)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED mashup 2 - recording playback' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

;mashup3
[tbl]
exten => mashup3,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'STARTING mashup 3 - fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/28_calls_fax_3.tif)
same => n,Set(DB(WESTILLFAX/step)=29)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHED mashup 3 - fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Hangup()

;LAST FAX
[ants]
exten => credits,1,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'STARTING credits - fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,SendFax(/fax/tifs/29_credits.tif)
same => n,Set(DB(WESTILLFAX/step)=30)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'ASTERISK LOGS' -u 'ASTERISK LOGS' -a '/var/log/asterisk/full' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'FINISHING credits - fax' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,System(> /var/log/asterisk/full)
same => n,Hangup()

[from-internal-custom]
exten => 1234,1,Answer()
    ;;Play mesage in English:
exten => 1234,n,agi(googletts.agi,"This is a simple google text to speech test in english.",en)
    ;;Play message in Spanish
exten => 1234,n,agi(googletts.agi,"Esta es una simple prueba en español.",es)
    ;;Play message in Greek
exten => 1234,n,agi(googletts.agi,"Αυτό είναι ένα απλό τέστ στα ελληνικά.",el)
exten => 1234,n,Hangup()

;between 18 and 21 there are no eggs
[from-internal-custom]
exten => noeggs,1,Verbose(1,no easter eggs in this step)
same => n,Hangup()

;EASTER EGGS 1 18 - 21
[from-internal-custom]
exten => 12345678,1,Verbose(1, easter eggs 1 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 12345678 (Egg 1)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=1)
same => n,Wait(44)
same => n,Hangup()

;EASTER EGGS 2
[from-internal-custom]
exten => 3124,1,Verbose(1, easter eggs 2 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 3124 (Egg 2)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=2)
same => n,Wait(71)
;same => n,Playback(faxmachine/eastereggs/Easter_Egg_2_Musk_3000)
same => n,Hangup()·

;EASTER EGGS 3
[from-internal-custom]
exten => 65,1,Verbose(1, easter eggs 3 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 65 (Egg 3)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=3)
same => n,Wait(25)
;same => n,Playback(faxmachine/eastereggs/Easter_Egg_3_Musk_65)
same => n,Hangup()

;EASTER EGGS 4
[from-internal-custom]
exten => 987,1,Verbose(1, easter eggs 4 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 987 (Egg 4)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=4)
same => n,Wait(43)
;same => n,Playback(faxmachine/eastereggs/Easter_Egg_4_Musk_900)
same => n,Hangup()

;EASTER EGGS 5
[from-internal-custom]
exten => 12101113,1,Verbose(1, easter eggs 5 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 12101113 (Egg 5)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=5)
same => n,Wait(70)
same => n,Hangup()

;EASTER EGGS 6 choose 1 2 3 to check
[from-internal-custom]
exten => 118118,1,Verbose(1, easter eggs 6 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 118118 (Egg 6)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Background(faxmachine/eastereggs/Easter_Egg_6_facts)
same => n,Hangup()

exten => 11,1,Wait(1)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have chosen bodies (Egg 6)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/eastereggs/Easter_Egg_6_1_bodies)
same => n,Hangup()

exten => 12,1,Wait(1)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have chosen animals (Egg 6)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/eastereggs/Easter_Egg_6_2_animals)
same => n,Hangup()

exten => 13,1,Wait(1)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have chosen hair (Egg 6)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/eastereggs/Easter_Egg_6_3_hair)
same => n,Hangup()

exten => i,1,Background(sorry)
same => n,Hangup()

;EASTER EGGS 7
[from-internal-custom]
exten => 05,1,Verbose(1, easter eggs 7 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 05 (Egg 7)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=23)
same => n,Wait(13)
same => n,Hangup()

;EASTER EGGS 23
[from-internal-custom]
exten => 75,1,Verbose(1, easter eggs 23 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 75 (Egg 23)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=23)
same => n,Wait(13)
same => n,Hangup()

;EASTER EGGS 24
[from-internal-custom]
exten => 475,1,Verbose(1, easter eggs 24 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 475 (Egg 23)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=23)
same => n,Wait(13)
same => n,Hangup()

;EASTER EGGS 8
[from-internal-custom]
exten => 6145,1,Verbose(1, easter eggs 8 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 6145 (Egg 8)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=8)
same => n,Wait(78)
same => n,Hangup()

;EASTER EGGS 9
[from-internal-custom]
exten => 0806,1,Verbose(1, easter eggs 9 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 0806 (Egg 9)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=9)
same => n,Wait(65)
same => n,Hangup()

;EASTER EGGS 10 to check
[from-internal-custom]
exten => 411,1,Verbose(1, easter eggs 10 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
exten => 411,2,Answer()
exten => 411,3,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 411 (Egg 10)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
exten => 411,4,Background(faxmachine/eastereggs/Easter_Egg_10_Intro)
exten => 411,5,Hangup()

exten => 66,1,Wait(1)
exten => 66,2,Answer()
exten => 66,3,Background(faxmachine/eastereggs/Easter_Egg_10_Stop1)
exten => 66,4,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 66 (STOP 1 - Egg 10)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
exten => 66,5,Background(faxmachine/eastereggs/Easter_Egg_10_Stop1.1)
exten => 66,6,Hangup()

exten => 77,1,Wait(1)
exten => 77,2,Answer()
exten => 77,3,Background(faxmachine/eastereggs/Easter_Egg_10_Stop2)
exten => 77,4,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 77 (STOP 2 - Egg 10)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
exten => 77,5,Background(faxmachine/eastereggs/Easter_Egg_10_Stop2.2)
exten =>77,6,Hungup()

exten => 88,1,Wait(1)
exten => 88,2,Answer()
exten => 88,3,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 88 (STOP 3 - Egg 10)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
exten => 88,4,Playback(faxmachine/eastereggs/Easter_Egg_10_Stop3)
exten => 88,5,Hungup()

exten => i,6,Background(sorry)
exten => i,7,Hungup()

;EASTER EGGS 11 a fax too
[from-internal-custom]
exten => 852ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=11)
same => n,Set(DB(WESTILLFAX/soundegg)=11)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 11' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 852,1,Verbose(1, easter eggs 11 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 852 (Egg 11)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg11)} = 0]?852ok,1)
same => n,Hangup()

;EASTER EGGS 12 a fax
[from-internal-custom]
exten => 10ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=12)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 12' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 10,1,Verbose(1, easter eggs 12 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 10 (Egg 12)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg12)} = 0]?10ok,1)
same => n,Hangup()
;EASTER EGGS 13
[from-internal-custom]
exten => 02,1,Verbose(1, easter eggs 13 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 02 (Egg 13)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=13)
same => n,Wait(62)
same => n,Hangup()

;EASTER EGGS 14 a fax too
[from-internal-custom]
exten => 1327ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=14)
same => n,Set(DB(WESTILLFAX/soundegg)=14)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 14' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 1327,1,Verbose(1, easter eggs 14 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 1327 (Egg 14)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg14)} = 0]?1327ok,1)
same => n,Hangup()

;EASTER EGGS 17
[from-internal-custom]
exten => 31712,1,Verbose(1, easter eggs 17 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 31712 (Egg 17)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=17)
same => n,Wait(120)
same => n,Hangup()

;EASTER EGGS 18
[from-internal-custom]
exten => 59135,1,Verbose(1, easter eggs 18 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 59135 (Egg 18)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=18)
same => n,Wait(55)
same => n,Hangup()

;EASTER EGGS 19 a fax too
[from-internal-custom]
exten => 234ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=19)
same => n,Set(DB(WESTILLFAX/soundegg)=19)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 19' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 234,1,Verbose(1, easter eggs 19 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 234 (Egg 19)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg19)} = 0]?234ok,1)
same => n,Hangup()
;EASTER EGGS 20
[from-internal-custom]
exten => 15,1,Verbose(1, easter eggs 20 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 15 (Egg 20)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=20)
same => n,Wait(11)
same => n,Hangup()

;EASTER EGGS 21
[from-internal-custom]
exten => 9,1,Verbose(1, easter eggs 21 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 9 (Egg 21)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=21)
same => n,Wait(52)
same => n,Hangup()

;EASTER EGGS 22 - 26 a fax too
[from-internal-custom]
exten => 931989ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=22)
same => n,Set(DB(WESTILLFAX/soundegg)=22)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 22 - 26' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 931989,1,Verbose(1, easter eggs 22 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 931989 (Egg 22 - 26)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg22)} = 0]?931989ok,1)
same => n,Hangup()

;EASTER EGGS 22 - 26 a fax too
[from-internal-custom]
exten => 031989ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=22)
same => n,Set(DB(WESTILLFAX/soundegg)=22)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 22 - 26' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 031989,1,Verbose(1, easter eggs 26 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 031989 (Egg 22 - 26)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg22)} = 0]?031989ok,1)
same => n,Hangup()

;EASTER EGGS 27
[from-internal-custom]
exten => 2009,1,Verbose(1, easter eggs 27 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 2009 (Egg 27)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=27)
same => n,Wait(44)
same => n,Hangup()

;EASTER EGGS 28
[from-internal-custom]
exten => 91015,1,Verbose(1, easter eggs 28 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 2009 (Egg 27)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=28)
same => n,Wait(51)
same => n,Hangup()

;EASTER EGGS 29
[from-internal-custom]
exten => 3433234,1,Verbose(1, easter eggs 29 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 3433234 (Egg 29)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=29)
same => n,Wait(233)
same => n,Hangup()

;EASTER EGGS 30 - fax and sound
[from-internal-custom]
exten => 3142ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=30)
same => n,Set(DB(WESTILLFAX/soundegg)=30)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 30' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 3142,1,Verbose(1, easter eggs 30 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 3142 (Egg 30)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg30)} = 0]?3142ok,1)
same => n,Hangup()

;EASTER EGGS 31 - fax and sound
[from-internal-custom]
exten => 02080806591,1,Verbose(1, easter eggs 31 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 02080806591 (Egg 31)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Set(DB(WESTILLFAX/soundegg)=31)
same => n,Wait(57)
same => n,Hangup()

;EASTER EGGS 32 - fax and sound
[from-internal-custom]
exten => 366ok,1,Playback(faxmachine/Incoming_Fax.1)
same => n,Set(DB(WESTILLFAX/faxegg)=32)
same => n,Set(DB(WESTILLFAX/soundegg)=32)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: SENDING faxegg 32' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,Playback(faxmachine/Incoming_Fax.2)

exten => 366,1,Verbose(1, easter eggs 32 received)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 18]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 19]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 20]?noeggs,1)
same => n,GosubIf($[${DB(WESTILLFAX/step)} = 21]?noeggs,1)
same => n,Answer()
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: They have dialed 366 (Egg 32)' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)
same => n,GosubIf($[${DB(WESTILLFAX/faxegg32)} = 0]?366ok,1)
same => n,Hangup()
;EASTER EGGS THAT WE SEND BACK

;11
[eastereggs]
exten => 11,1,Verbose(1,sending fax back)
same => n,SendFax(/fax/tifs/Easter_Egg_11_Disco.tif)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: FINISHED faxegg 11' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;12
exten => 12,1,Verbose(1,sending fax back)
same => n,SendFax(/fax/tifs/Easter_Egg_12_present.tif)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: FINISHED faxegg 12' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;14
exten => 14,1,Verbose(1,sending fax back)
same => n,SendFax(/fax/tifs/Easter_Egg_14_Mars.tif)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: FINISHED faxegg 14' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;19
exten => 19,1,Verbose(1,sending fax back)
same => n,SendFax(/fax/tifs/Easter_Egg_19_Dare.tif)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: FINISHED faxegg 19' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;22
exten => 22,1,Verbose(1,sending fax back)
same => n,SendFax(/fax/tifs/Easter_Egg_22_proposal.tif)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: FINISHED faxegg 22' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;30
exten => 30,1,Verbose(1,sending fax back)
same => n,SendFax(/fax/tifs/Easter_Egg_30_universe.tif)
same => n,System(sendemail -f diana.vallverdu@gmail.com -t helpline.wsf.2@gmail.com -m 'EASTER EGG: FINISHED faxegg 30' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;32
exten =>32,1,Verbose(1,sending fax back)
same => n, SendFax(/fax/tifs/Easter_Egg_32_Artefact.tif)
same => n, n,System(sendemail -f diana.vallverdu@gmail.com -t antsonstiltstheatre@gmail.com -m 'EASTER EGG: FINISHED faxegg 32' -u 'Machine ${MACHINE}' -xu diana.vallverdu@gmail.com -xp fcnxcntclkxrrxvd -s smtp.gmail.com)

;AUXILIAR
[from-internal-custom]
exten => 461414614146141,1,Verbose(1,reset show)
same => n,Set(DB(WESTILLFAX/step)=00)
same => n,Hangup()

[from-internal-custom]
exten => 490014900149001,1,Verbose(1,reset show)
same => n,System(reboot)
same => n,Hangup()

;[from-internal-custom]
;exten => 124131241312413,1,Verbose(1,reset show)
;same => n,System(tmate -S /tmp/tmate.sock new-session -d)
;same => n,System(tmate -S /tmp/tmate.sock wait tmate-ready)

;TESTER
[tester]
exten =>tester,1,SendFax(/fax/tifs/tester.tif)
same => n,Hangup()
